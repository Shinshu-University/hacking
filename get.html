<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="robots" content="none">
    <title>get</title>
    <script>
      let data = [];
  const socket = new WebSocket('wss://cloud.achex.ca/hackingdemo');

  socket.addEventListener('open', function (event) {
    socket.send('{"auth":"admin", "password":"pass"}');
  });

  socket.addEventListener('message', function (event) {
    const json = JSON.parse(event.data)
    if (json.auth == 'OK') {
      return
    }
    console.log(json.msg);
    if (json.msg == 'finish') {
      console.log(data.join(''));
      const a = document.createElement('a');
      a.href = data.join('');
      a.download = 'image.png';
      a.click();
      data = [];
    } else {
      data[data.length] = json.msg;
    }
  })
    </script>
  </head>
  <body>
    <h1>GET</h1>
  </body>
</html>
